!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@ledgerhq/hw-transport")):"function"==typeof define&&define.amd?define(["exports","@ledgerhq/hw-transport"],r):r((e=e||self).ledgerBridge={},e.LedgerTransport)}(this,function(e,r){var t;r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,(t=e.BridgeMessageType||(e.BridgeMessageType={})).ExchangeRequest="THANOS_LEDGER_BRIDGE_EXCHANGE_REQUEST",t.ExchangeResponse="THANOS_LEDGER_BRIDGE_EXCHANGE_RESPONSE",t.ErrorResponse="THANOS_LEDGER_ERROR_RESPONSE",e.LedgerThanosBridgeTransport=function(r){var t,n;function o(e){var t;return(t=r.call(this)||this).iframe=e,t}n=r,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.isSupported=function(){return Promise.resolve(!0)},o.list=function(){return Promise.resolve([])},o.listen=function(){return{unsubscribe:function(){}}},o.open=function(e){try{var r=document.createElement("iframe");return r.src=e,document.head.appendChild(r),Promise.resolve(new Promise(function(e){r.addEventListener("load",function t(){e(),r.removeEventListener("load",t)})})).then(function(){return new o(r)})}catch(e){return Promise.reject(e)}};var i,s=o.prototype;return s.exchange=function(r){var t=this;return new Promise(function(n,o){try{var i,s,a=t.exchangeTimeout,c={type:e.BridgeMessageType.ExchangeRequest,apdu:r.toString("hex"),scrambleKey:null===(i=t.scrambleKey)||void 0===i?void 0:i.toString("ascii"),exchangeTimeout:a};return null===(s=t.iframe.contentWindow)||void 0===s||s.postMessage(c,"*"),window.addEventListener("message",function r(i){if(i.origin===t.origin){var s=i.data;switch(null==s?void 0:s.type){case e.BridgeMessageType.ExchangeResponse:n(Buffer.from(s.result,"hex"));break;case e.BridgeMessageType.ErrorResponse:o(s.message)}window.removeEventListener("message",r)}}),Promise.resolve()}catch(e){return Promise.reject(e)}})},s.setScrambleKey=function(e){this.scrambleKey=Buffer.from(e,"ascii")},s.close=function(){try{return document.head.removeChild(this.iframe),Promise.resolve()}catch(e){return Promise.reject(e)}},(i=[{key:"origin",get:function(){var e=this.iframe.src.split("/");return e.splice(-1,1),e.join("/")}}])&&function(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(o.prototype,i),o}(r)});
//# sourceMappingURL=index.umd.js.map
