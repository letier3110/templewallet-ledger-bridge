import e from"@ledgerhq/hw-transport";var t;!function(e){e.ExchangeRequest="THANOS_LEDGER_BRIDGE_EXCHANGE_REQUEST",e.ExchangeResponse="THANOS_LEDGER_BRIDGE_EXCHANGE_RESPONSE",e.ErrorResponse="THANOS_LEDGER_ERROR_RESPONSE"}(t||(t={}));class s extends e{constructor(e,t){super(),this.iframe=e,this.bridgeUrl=t}static async isSupported(){return!0}static async list(){return[]}static listen(){return{unsubscribe:()=>{}}}static async open(e){const t=document.createElement("iframe");return t.src=e,document.head.appendChild(t),new s(t,e)}exchange(e){return new Promise((s,r)=>{var n,i;const a={type:t.ExchangeRequest,apdu:e.toString(),scrambleKey:null===(n=this.scrambleKey)||void 0===n?void 0:n.toString(),exchangeTimeout:this.exchangeTimeout};null===(i=this.iframe.contentWindow)||void 0===i||i.postMessage(a,"*");const o=e=>{if(e.origin!==this.getOrigin())return;const n=e.data;switch(null==n?void 0:n.type){case t.ExchangeResponse:s(Buffer.from(n.result));break;case t.ErrorResponse:r(n.message)}window.removeEventListener("message",o)};window.addEventListener("message",o)})}setScrambleKey(e){this.scrambleKey=Buffer.from(e,"ascii")}setUnwrap(e){this.unwrap=e}async close(){document.head.removeChild(this.iframe)}getOrigin(){const e=this.bridgeUrl.split("/");return e.splice(-1,1),e.join("/")}}export{t as BridgeMessageType,s as LedgerThanosBridgeTransport};
//# sourceMappingURL=index.modern.js.map
