import e from"@ledgerhq/hw-transport";var r;!function(e){e.ExchangeRequest="THANOS_LEDGER_BRIDGE_EXCHANGE_REQUEST",e.ExchangeResponse="THANOS_LEDGER_BRIDGE_EXCHANGE_RESPONSE",e.ErrorResponse="THANOS_LEDGER_ERROR_RESPONSE"}(r||(r={}));var t=function(e){var t,n;function o(r){var t;return(t=e.call(this)||this).iframe=r,t}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,o.isSupported=function(){return Promise.resolve(!0)},o.list=function(){return Promise.resolve([])},o.listen=function(){return{unsubscribe:function(){}}},o.open=function(e){try{var r=document.createElement("iframe");return r.src=e,document.head.appendChild(r),Promise.resolve(new Promise(function(e){r.addEventListener("load",function t(){e(),r.removeEventListener("load",t)})})).then(function(){return new o(r)})}catch(e){return Promise.reject(e)}};var i,s=o.prototype;return s.exchange=function(e){var t=this;return new Promise(function(n,o){try{var i,s,c=t.exchangeTimeout,a={type:r.ExchangeRequest,apdu:e.toString("hex"),scrambleKey:null===(i=t.scrambleKey)||void 0===i?void 0:i.toString("ascii"),exchangeTimeout:c};return null===(s=t.iframe.contentWindow)||void 0===s||s.postMessage(a,"*"),window.addEventListener("message",function e(i){if(i.origin===t.origin){var s=i.data;switch(null==s?void 0:s.type){case r.ExchangeResponse:n(Buffer.from(s.result,"hex"));break;case r.ErrorResponse:o(s.message)}window.removeEventListener("message",e)}}),Promise.resolve()}catch(e){return Promise.reject(e)}})},s.setScrambleKey=function(e){this.scrambleKey=Buffer.from(e,"ascii")},s.close=function(){try{return document.head.removeChild(this.iframe),Promise.resolve()}catch(e){return Promise.reject(e)}},(i=[{key:"origin",get:function(){var e=this.iframe.src.split("/");return e.splice(-1,1),e.join("/")}}])&&function(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(o.prototype,i),o}(e);export{r as BridgeMessageType,t as LedgerThanosBridgeTransport};
//# sourceMappingURL=index.module.js.map
