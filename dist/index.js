var e,r,t=(e=require("@ledgerhq/hw-transport"))&&"object"==typeof e&&"default"in e?e.default:e;(r=exports.BridgeMessageType||(exports.BridgeMessageType={})).ExchangeRequest="THANOS_LEDGER_BRIDGE_EXCHANGE_REQUEST",r.ExchangeResponse="THANOS_LEDGER_BRIDGE_EXCHANGE_RESPONSE",r.ErrorResponse="THANOS_LEDGER_ERROR_RESPONSE",exports.LedgerThanosBridgeTransport=function(e){var r,t;function n(r){var t;return(t=e.call(this)||this).iframe=r,t}t=e,(r=n).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t,n.isSupported=function(){return Promise.resolve(!0)},n.list=function(){return Promise.resolve([])},n.listen=function(){return{unsubscribe:function(){}}},n.open=function(e){try{var r=document.createElement("iframe");return r.src=e,document.head.appendChild(r),Promise.resolve(new Promise(function(e){r.addEventListener("load",function t(){e(),r.removeEventListener("load",t)})})).then(function(){return new n(r)})}catch(e){return Promise.reject(e)}};var o,i=n.prototype;return i.exchange=function(e){var r=this;return new Promise(function(t,n){try{var o,i,s=r.exchangeTimeout,a={type:exports.BridgeMessageType.ExchangeRequest,apdu:e.toString("hex"),scrambleKey:null===(o=r.scrambleKey)||void 0===o?void 0:o.toString("ascii"),exchangeTimeout:s};return null===(i=r.iframe.contentWindow)||void 0===i||i.postMessage(a,"*"),window.addEventListener("message",function e(o){if(o.origin===r.origin){var i=o.data;switch(null==i?void 0:i.type){case exports.BridgeMessageType.ExchangeResponse:t(Buffer.from(i.result,"hex"));break;case exports.BridgeMessageType.ErrorResponse:n(i.message)}window.removeEventListener("message",e)}}),Promise.resolve()}catch(e){return Promise.reject(e)}})},i.setScrambleKey=function(e){this.scrambleKey=Buffer.from(e,"ascii")},i.close=function(){try{return document.head.removeChild(this.iframe),Promise.resolve()}catch(e){return Promise.reject(e)}},(o=[{key:"origin",get:function(){var e=this.iframe.src.split("/");return e.splice(-1,1),e.join("/")}}])&&function(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(n.prototype,o),n}(t);
//# sourceMappingURL=index.js.map
