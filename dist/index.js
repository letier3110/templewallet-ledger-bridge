var e,r,t=(e=require("@ledgerhq/hw-transport"))&&"object"==typeof e&&"default"in e?e.default:e;(r=exports.BridgeMessageType||(exports.BridgeMessageType={})).ExchangeRequest="THANOS_LEDGER_BRIDGE_EXCHANGE_REQUEST",r.ExchangeResponse="THANOS_LEDGER_BRIDGE_EXCHANGE_RESPONSE",r.ErrorResponse="THANOS_LEDGER_ERROR_RESPONSE",exports.LedgerThanosBridgeTransport=function(e){var r,t;function n(r,t){var n;return(n=e.call(this)||this).iframe=r,n.bridgeUrl=t,n}t=e,(r=n).prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t,n.isSupported=function(){return Promise.resolve(!0)},n.list=function(){return Promise.resolve([])},n.listen=function(){return{unsubscribe:function(){}}},n.open=function(){try{var e="https://thanoswallet.com/ledger-bridge",r=document.createElement("iframe");return r.src=e,document.head.appendChild(r),Promise.resolve(new n(r,e))}catch(e){return Promise.reject(e)}};var o=n.prototype;return o.exchange=function(e){var r=this;return new Promise(function(t,n){var o,s,i={type:exports.BridgeMessageType.ExchangeRequest,apdu:e.toString(),scrambleKey:null===(o=r.scrambleKey)||void 0===o?void 0:o.toString(),exchangeTimeout:r.exchangeTimeout};null===(s=r.iframe.contentWindow)||void 0===s||s.postMessage(i,"*"),window.addEventListener("message",function e(o){if(o.origin===r.getOrigin()){var s=o.data;switch(null==s?void 0:s.type){case exports.BridgeMessageType.ExchangeResponse:t(Buffer.from(s.result));break;case exports.BridgeMessageType.ErrorResponse:n(s.message)}window.removeEventListener("message",e)}})})},o.setScrambleKey=function(e){this.scrambleKey=Buffer.from(e,"ascii")},o.setUnwrap=function(e){this.unwrap=e},o.close=function(){try{return document.head.removeChild(this.iframe),Promise.resolve()}catch(e){return Promise.reject(e)}},o.getOrigin=function(){var e=this.bridgeUrl.split("/");return e.splice(-1,1),e.join("/")},n}(t);
//# sourceMappingURL=index.js.map
